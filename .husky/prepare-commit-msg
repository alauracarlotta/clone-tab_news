MSG_FILE="$1"
COMMIT_SOURCE="$2"

if [ "$COMMIT_SOURCE" = "commit" ]; then
  exit 0
fi

if [ "$COMMIT_SOURCE" = "message" ]; then
  exit 0
fi

empty_msg() {
  contents=$(grep -vE '^(#|$)' "$MSG_FILE")
  [ -z "$contents" ]
}

if empty_msg; then
  exec < /dev/tty
  npx cz --hook || true
fi

exit 0
